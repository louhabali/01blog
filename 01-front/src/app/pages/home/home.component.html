<div class="home-container">
  <!-- Users Panel is now UsersComponent -->
  <app-users class="users-panel" [ngClass]="{'dark-mode': isDarkMode}" [isDarkMode]="isDarkMode"></app-users>

  <!-- Posts Panel -->
  <div class="posts-panel" [ngClass]="{'dark-mode': isDarkMode}">
     <i (click)="toggleTheme()" class="fa-solid fa-circle-half-stroke theme-icon"></i>
    <!-- Post Creation Form -->
    <div class="post-form">
      <input type="file" (change)="onFileSelected($event)" />
      <input type="text" placeholder="Post title" [(ngModel)]="newPost.title">
      <textarea placeholder="Post content" [(ngModel)]="newPost.content"></textarea>
      <button (click)="submitPost()">Post</button>
    </div>

    <!-- Posts Grid -->
    <div class="posts-grid">
  <div class="post-card" *ngFor="let post of posts">
    <div class="post-header">
      <img [src]="post.avatar ? post.avatar : 'default-avatar.png'" alt="{{post.authorName}}">
      <span>{{ post.authorName }}</span>
    </div>

    <!-- Title -->
    <div *ngIf="!post.isEditing; else editTitle">
      <h5>{{ post.title }}</h5>
    </div>
    <ng-template #editTitle>
      <input [(ngModel)]="post.title" class="edit-input" />
    </ng-template>
    <!--media-->
    <div *ngIf="post.imageUrl">
  <img [src]="post.imageUrl" alt="post image" style="max-width:100%; border-radius:10px;" />
</div>

<div *ngIf="post.videoUrl">
  <video controls [src]="post.videoUrl" style="max-width:100%; border-radius:10px;"></video>
</div>
    <!-- Content -->
    <div >
      <p style="font-size: 0.7em;">{{ post.content | slice:0:25 }}<a style="cursor: pointer; color: rgb(48, 85, 216);" (click)="goTopostdetails(post)">   ...</a></p>
    </div>
    <ng-template>
      <textarea [(ngModel)]="post.content" class="edit-textarea"></textarea>
    </ng-template>

    <!-- Like + Comment -->
    <div class="post-actions">
  <i class="fa-heart"
     [ngClass]="post.liked ? 'fa-solid text-red-500' : 'fa-regular'"
     (click)="toggleLike(post)">
  </i>
  <span>{{ post.likes || 0 }}</span>

</div>

    <!-- Buttons -->
    <!-- Buttons -->
<div class="post-buttons">
  <ng-container *ngIf="post.authorId === currentUserId; else reportOnly">
    <i (click)="deletePost(post)" class="fas fa-trash"></i>
  </ng-container>

  <!-- If not the author, show only Report -->
  <ng-template #reportOnly>
    <i (click)="reportPost(post)" class="fa-solid fa-triangle-exclamation"></i>
  </ng-template>
</div>
  </div>
</div>

  </div>
</div>
